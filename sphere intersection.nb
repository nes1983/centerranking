(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     91086,       2122]
NotebookOptionsPosition[     87529,       2000]
NotebookOutlinePosition[     87924,       2017]
CellTagsIndexPosition[     87881,       2014]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Sphere intersection algorithm", "Title",
 CellChangeTimes->{{3.457164280899469*^9, 3.4571642851588697`*^9}, {
   3.4571643863132963`*^9, 3.457164418885285*^9}, {3.457164524464776*^9, 
   3.457164539489275*^9}, 3.457164605815013*^9, {3.457255104131278*^9, 
   3.457255108191806*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BeginPackage", "[", 
    RowBox[{"\"\<Niko`\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Combinatorica`\>\"", ",", "\"\<Niko`\>\""}], "}"}]}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"intersection", ",", " ", 
     RowBox[{
     "one", " ", "ball", " ", "center", " ", "fixed", " ", "to", " ", 
      "identity"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"intersection", ",", "intersectionGen"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intersection", "[", 
     RowBox[{"\[Lambda]_List", ",", "r_Integer", ",", 
      RowBox[{"ilam_Integer:", "0"}], ",", 
      RowBox[{"i1_Integer:", "0"}], ",", 
      RowBox[{"\[Nu]_List:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{"intersectionGen", "[", 
        RowBox[{
        "\[Lambda]", ",", "r", ",", "Sow", ",", "ilam", ",", "i1", ",", 
         "\[Nu]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intersectionGen", "[", 
     RowBox[{"\[Lambda]_List", ",", "r_Integer", ",", "gen_", ",", 
      RowBox[{"ilam_Integer:", "0"}], ",", 
      RowBox[{"i1_Integer:", "0"}], ",", 
      RowBox[{"\[Nu]_List:", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "\[Lambda]", "]"}]}], ",", "DD", ",", 
        RowBox[{"li", "=", " ", 
         RowBox[{"InversePermutation", "[", "\[Lambda]", "]"}]}]}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Abort", " ", "conditions"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{
           RowBox[{"tau", "[", 
            RowBox[{"\[Lambda]", ",", 
             RowBox[{"Range", "[", "n", "]"}]}], "]"}], "\[LessEqual]", " ", 
           RowBox[{"2", " ", "r"}]}], "]"}], ",", 
         RowBox[{"Throw", "[", 
          RowBox[{"\"\<There cannot be a solution\>\"", ",", 
           RowBox[{"intersection", "::", "noSolution"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "\[Lambda]"}], " ", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"gen", "[", 
           RowBox[{"\[CapitalRho]", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "[", "\[Lambda]", "]"}], ",", "\[Nu]"}], "}"}],
             "]"}], "]"}], ";", 
          RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"(*", "Execution", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"DD", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"Function", "[", 
           RowBox[{"d", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"li", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], "-", "1", "+", 
                RowBox[{"tau", "[", 
                 RowBox[{
                  RowBox[{"\[Lambda]", "\[VerticalSeparator]", "d"}], ",", 
                  RowBox[{"Range", "[", 
                   RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}], "\[LessEqual]", 
               " ", 
               RowBox[{
                RowBox[{"2", " ", "r"}], " ", "-", " ", "ilam", "-", "i1"}]}],
               ")"}], "\[IndentingNewLine]", "\[And]", 
             RowBox[{
              RowBox[{"d", "-", "1"}], "\[LessEqual]", " ", 
              RowBox[{"r", "-", "i1"}]}], "\[And]", 
             RowBox[{
              RowBox[{
               RowBox[{"li", "[", 
                RowBox[{"[", "d", "]"}], "]"}], "-", "1"}], "\[LessEqual]", 
              " ", 
              RowBox[{"r", "-", "ilam"}]}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Scan", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"d", ",", "\[IndentingNewLine]", "  ", 
           RowBox[{"intersectionGen", "[", 
            RowBox[{
             RowBox[{"\[Lambda]", "  ", "\[VerticalSeparator]", " ", "d"}], 
             ",", " ", "r", ",", "gen", ",", 
             RowBox[{"ilam", "+", 
              RowBox[{"li", "[", 
               RowBox[{"[", "d", "]"}], "]"}], "-", "1"}], ",", 
             RowBox[{"i1", "+", "d", "-", "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "\[Nu]"}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", "DD"}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "example", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intersection", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "}"}], ",", "1"}], "]"}], 
    "==", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"intersection", " ", "algorithm"}], ",", " ", 
     RowBox[{"both", " ", "centers", " ", "free"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"intersection2", ",", "intersection2Gen"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"intersection2", "[", 
      RowBox[{"inp_List", ",", "r_Integer"}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"intersection2Gen", "[", 
         RowBox[{"inp", ",", "r", ",", "Sow"}], "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intersection2Gen", "[", 
     RowBox[{"inp_List", ",", "r_Integer", ",", "fun_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]", ",", "\[Mu]", ",", "li"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"li", " ", "=", 
        RowBox[{"InversePermutation", "[", "\[Lambda]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "choose", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", " ", 
        RowBox[{"inp", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Mu]", "=", " ", 
        RowBox[{"SelectMaximizer", "[", 
         RowBox[{"inp", ",", 
          RowBox[{
           RowBox[{"\[Tau]", "[", 
            RowBox[{"\[Lambda]", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "verify", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{
           RowBox[{"\[Tau]", "[", 
            RowBox[{"\[Lambda]", ",", "\[Mu]"}], "]"}], "\[LessEqual]", " ", 
           RowBox[{"2", " ", "r"}]}], "]"}], ",", 
         RowBox[{"Throw", "[", 
          RowBox[{"\"\<There cannot be a solution\>\"", ",", 
           RowBox[{"intersection", "::", "noSolution"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", "run", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"intersectionGen", "[", 
        RowBox[{
         RowBox[{"li", "[", 
          RowBox[{"[", "\[Mu]", "]"}], "]"}], ",", "r", ",", 
         RowBox[{
          RowBox[{"fun", "[", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intersection2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], "}"}], ",", 
      "1"}], "]"}], "\[Equal]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", 
    RowBox[{"intersection3", ",", "intersection3All"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"intersection3All", "[", "inp_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"abort", "=", "False"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Reap", "[", "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"$RecursionLimit", "=", "512"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"r", "=", "0"}], ",", 
               RowBox[{"Not", "[", "abort", "]"}], ",", 
               RowBox[{"r", "++"}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Catch", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"intersection2Gen", "[", 
                   RowBox[{"inp", ",", "r", ",", "\[IndentingNewLine]", 
                    RowBox[{"Function", "[", 
                    RowBox[{"q", ",", " ", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"score", "[", "q", "]"}], "\[Equal]", " ", "r"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"abort", "=", "True"}], ";", 
                    RowBox[{"Sow", "[", "q", "]"}]}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                   "]"}], ",", 
                  RowBox[{"intersection", "::", "\"\<noSolution\>\""}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "\[IndentingNewLine]", "]"}], ";", 
             RowBox[{"r", "-", "1"}]}]}], " ", 
           RowBox[{"(*", 
            RowBox[{
            "why", " ", "on", " ", "earth", " ", "is", " ", "it", " ", 
             "minus", " ", 
             RowBox[{"one", " ", "?", "!"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Now", " ", "with", " ", "a", " ", "score"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intersection3", "[", "inp_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"$RecursionLimit", "=", "512"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Catch", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"r", "=", "0"}], ",", "True", ",", 
            RowBox[{"r", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Catch", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"intersection2Gen", "[", 
                RowBox[{"inp", ",", "r", ",", "\[IndentingNewLine]", 
                 RowBox[{"Function", "[", 
                  RowBox[{"q", ",", " ", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"score", "[", "q", "]"}], "\[Equal]", " ", "r"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Sow", "[", "q", "]"}], ";", 
                    RowBox[{"Throw", "[", "r", "]"}]}]}], "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "]"}], ",", 
               RowBox[{"intersection", "::", "\"\<noSolution\>\""}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Global`inp", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "}"}]}], "}"}]}], 
       "}"}], ",", " ", 
      RowBox[{"intersection3", "[", "Global`inp", "]"}]}], "]"}], "\[Equal]", 
    " ", "1"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"EndPackage", "[", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DumpSave", "[", 
     RowBox[{"\"\<niko.mx\>\"", ",", "\"\<Niko`\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.457164425795023*^9, 3.457164476229576*^9}, {
   3.4571645632686167`*^9, 3.457164699968811*^9}, {3.457165634758206*^9, 
   3.457165661133666*^9}, {3.457165693467716*^9, 3.457165866872014*^9}, {
   3.457166158302924*^9, 3.457166195087837*^9}, {3.457166229176325*^9, 
   3.4571662300482903`*^9}, {3.457167619151506*^9, 3.457167623789794*^9}, {
   3.457167654649887*^9, 3.457167722699151*^9}, {3.457178109867178*^9, 
   3.457178112422922*^9}, {3.4571806420161037`*^9, 3.457180689751976*^9}, {
   3.457180964367773*^9, 3.45718108046388*^9}, {3.457181134334622*^9, 
   3.457181144051653*^9}, {3.4571811935502453`*^9, 3.457181293620934*^9}, {
   3.457182421347205*^9, 3.4571828911720057`*^9}, {3.457182946983573*^9, 
   3.457182956261895*^9}, 3.457183055450593*^9, {3.457183133137905*^9, 
   3.457183227079589*^9}, {3.4571841767701178`*^9, 3.457184199487192*^9}, {
   3.4571852245968027`*^9, 3.4571853211659937`*^9}, {3.4571853669075527`*^9, 
   3.457185404507204*^9}, {3.457185440120928*^9, 3.4571854909379597`*^9}, 
   3.4571855795685797`*^9, {3.4571856184485197`*^9, 3.457185622327927*^9}, {
   3.457185670132607*^9, 3.4571856731963587`*^9}, {3.457185754675788*^9, 
   3.4571857566576967`*^9}, {3.457185790750695*^9, 3.457185916307539*^9}, {
   3.4571869336703863`*^9, 3.457186970562467*^9}, {3.457187397701645*^9, 
   3.457187413514555*^9}, {3.457187454958384*^9, 3.457187590605858*^9}, 
   3.4571876496204443`*^9, {3.457187706663437*^9, 3.457187710300867*^9}, {
   3.457187824942417*^9, 3.457187902200871*^9}, {3.4571879444567633`*^9, 
   3.4571879528441477`*^9}, {3.45718803894779*^9, 3.45718806846874*^9}, {
   3.45718810380898*^9, 3.457188104109583*^9}, {3.457188146427793*^9, 
   3.457188150054113*^9}, {3.45718819176124*^9, 3.457188207796701*^9}, {
   3.457188296077751*^9, 3.45718835904051*^9}, {3.4571884341730213`*^9, 
   3.4571884363382196`*^9}, 3.4571884855332537`*^9, {3.457188537976918*^9, 
   3.457188538148637*^9}, {3.457188577527398*^9, 3.457188834446218*^9}, {
   3.457188878671646*^9, 3.457188911720866*^9}, {3.457254079296258*^9, 
   3.457254089298451*^9}, {3.45725417220815*^9, 3.4572541807870092`*^9}, {
   3.457254212615899*^9, 3.457254246922123*^9}, {3.457254966906735*^9, 
   3.457255046303605*^9}, {3.4574515064600353`*^9, 3.457451512588407*^9}, {
   3.4574515715667152`*^9, 3.4574515900989227`*^9}, {3.457451625773788*^9, 
   3.457451676532551*^9}, {3.457451818299666*^9, 3.457451821726516*^9}, 
   3.457451856063795*^9, {3.457452455068651*^9, 3.457452473189337*^9}, {
   3.457452538462356*^9, 3.457452539578252*^9}, {3.457453124718196*^9, 
   3.4574531247760763`*^9}, {3.4574531765657988`*^9, 3.45745317707218*^9}, {
   3.457513130156597*^9, 3.4575131495572443`*^9}, {3.457513200794338*^9, 
   3.457513295296904*^9}, {3.457513962037015*^9, 3.457513962222208*^9}, {
   3.457514015609866*^9, 3.4575140513934097`*^9}, {3.457518420544242*^9, 
   3.4575184212071238`*^9}, {3.457523425478998*^9, 3.457523445717157*^9}, {
   3.457523530322628*^9, 3.4575235465471773`*^9}, {3.457523706658197*^9, 
   3.457523858045251*^9}, {3.457523899094489*^9, 3.457523904384933*^9}, {
   3.457523984694846*^9, 3.457524034873687*^9}, {3.457524070057844*^9, 
   3.457524075367371*^9}, {3.4575241576797943`*^9, 3.457524196725429*^9}, {
   3.457524252022711*^9, 3.457524320325673*^9}, {3.457524451556243*^9, 
   3.457524484334428*^9}, {3.457524661355995*^9, 3.457524689319849*^9}, {
   3.457524772018405*^9, 3.457524790465425*^9}, {3.457524884376498*^9, 
   3.457524888077026*^9}, {3.457525360118258*^9, 3.457525678426078*^9}, {
   3.457525709096607*^9, 3.457525736119665*^9}, {3.457525797114146*^9, 
   3.457525824136222*^9}, {3.4575259039550056`*^9, 3.4575259136870003`*^9}, {
   3.4575259593243*^9, 3.4575259866311197`*^9}, {3.457526045096306*^9, 
   3.457526101590207*^9}, {3.457526185315117*^9, 3.457526205073928*^9}, {
   3.457526265918318*^9, 3.4575262700850363`*^9}, {3.457526361507946*^9, 
   3.457526419454917*^9}, {3.457526467899281*^9, 3.457526488306036*^9}, {
   3.4575265456596947`*^9, 3.457526613400931*^9}, {3.457526653707285*^9, 
   3.4575266845474*^9}, {3.457526722451097*^9, 3.457526737101613*^9}, {
   3.4575282972569447`*^9, 3.457528361001096*^9}, {3.457528411272743*^9, 
   3.457528431338915*^9}, {3.457528504012498*^9, 3.4575285165435123`*^9}, {
   3.457528613062969*^9, 3.457528617050218*^9}, {3.457532101692341*^9, 
   3.457532128127804*^9}, {3.4575349429043818`*^9, 3.457535084722603*^9}, {
   3.457616081528137*^9, 3.457616083756256*^9}, {3.457761131400193*^9, 
   3.457761133226474*^9}, 3.457761188582431*^9, {3.4577614331139708`*^9, 
   3.457761433370164*^9}, {3.457761774761547*^9, 3.4577618089814787`*^9}, {
   3.4577643954776173`*^9, 3.4577645002556057`*^9}, {3.45776453293565*^9, 
   3.457764768006*^9}, {3.457764906693708*^9, 3.457764918700268*^9}, {
   3.4577654819107924`*^9, 3.457765539052848*^9}, {3.457765710430538*^9, 
   3.457765720414757*^9}, {3.4577658255283937`*^9, 3.457765834310384*^9}, {
   3.457765924788164*^9, 3.4577661674495163`*^9}, {3.4577661994535007`*^9, 
   3.45776628778011*^9}, 3.4577663320586033`*^9, {3.457766375667742*^9, 
   3.457766430171653*^9}, {3.4577753154233*^9, 3.4577753287858963`*^9}, {
   3.457775435333346*^9, 3.457775437155183*^9}, {3.4577755419586887`*^9, 
   3.457775562709838*^9}, 3.4577770928069363`*^9, {3.457777592305146*^9, 
   3.457777628279817*^9}, {3.457777747429873*^9, 3.457777751802073*^9}, 
   3.457784363887648*^9, {3.4577847736377287`*^9, 3.4577848577336407`*^9}, {
   3.4577865563944798`*^9, 3.457786571203856*^9}, {3.45779824348696*^9, 
   3.45779830777*^9}, 3.457798364112154*^9, {3.4577984150822477`*^9, 
   3.457798570882403*^9}, {3.45779861671437*^9, 3.4577988620418386`*^9}, {
   3.457849310944283*^9, 3.457849414191105*^9}, {3.457953371440743*^9, 
   3.457953371868191*^9}, {3.4579536779729347`*^9, 3.457953691776524*^9}, {
   3.457953770325676*^9, 3.4579538140999727`*^9}, {3.457953948119028*^9, 
   3.4579539769525414`*^9}, {3.4579554802867327`*^9, 3.457955574207971*^9}, {
   3.458293236226653*^9, 3.4582932556948977`*^9}, {3.4583870817639723`*^9, 
   3.458387084379258*^9}, {3.458625662077551*^9, 3.4586257194048977`*^9}, {
   3.4586257533238897`*^9, 3.458625826149909*^9}, {3.458626025616349*^9, 
   3.4586260349309587`*^9}, {3.4586265054901457`*^9, 3.458626586822453*^9}, {
   3.458884207219482*^9, 3.4588842392946987`*^9}, {3.459093532990258*^9, 
   3.4590935372001038`*^9}, {3.45909388668475*^9, 3.459093914913954*^9}, {
   3.459093954620659*^9, 3.4590939710738*^9}, {3.4590986222805843`*^9, 
   3.459098631881199*^9}, {3.4598389924408607`*^9, 3.459839008863735*^9}, {
   3.45983906713555*^9, 3.4598390717347803`*^9}, {3.460118834109869*^9, 
   3.460118841307311*^9}, {3.460118918236437*^9, 3.460118947885313*^9}, {
   3.460119029817819*^9, 3.460119034541213*^9}, {3.460121265898408*^9, 
   3.460121328350528*^9}, {3.460393731357655*^9, 3.460393785195026*^9}}],

Cell[BoxData["\<\"Niko`\"\>"], "Output",
 CellChangeTimes->{{3.457525963954905*^9, 3.457525988058708*^9}, {
   3.4575260469837723`*^9, 3.457526071702159*^9}, 3.457526103652482*^9, {
   3.4575262076547813`*^9, 3.457526237022325*^9}, 3.4575262710644627`*^9, {
   3.457526393361498*^9, 3.4575264199736967`*^9}, 3.457526489364911*^9, {
   3.457526548514436*^9, 3.45752656446655*^9}, 3.457526614290103*^9, 
   3.45752668525624*^9, {3.4575267241454563`*^9, 3.457526738136475*^9}, 
   3.457528362665086*^9, 3.45752839693546*^9, 3.4575284319968443`*^9, 
   3.457528517716673*^9, {3.457528588209323*^9, 3.457528617695696*^9}, 
   3.457532494342081*^9, 3.457534897277375*^9, {3.4575349378832493`*^9, 
   3.4575349804387093`*^9}, {3.4575350284661493`*^9, 3.457535085954796*^9}, 
   3.457593014857099*^9, {3.457616063575787*^9, 3.457616084323604*^9}, {
   3.457616127254602*^9, 3.457616131498653*^9}, 3.457761134485507*^9, 
   3.457761194420431*^9, 3.457761434465074*^9, 3.4577618119392157`*^9, {
   3.457764561146598*^9, 3.4577645734289494`*^9}, {3.4577646571758747`*^9, 
   3.457764679772084*^9}, 3.45776471285743*^9, {3.457764743683632*^9, 
   3.457764768990488*^9}, 3.457764919481948*^9, {3.457765484558496*^9, 
   3.4577655073946257`*^9}, 3.457765728639798*^9, {3.457765767734953*^9, 
   3.4577657854578457`*^9}, {3.457765826725992*^9, 3.457765835609083*^9}, {
   3.4577661738508387`*^9, 3.4577662002369204`*^9}, 3.4577662470731907`*^9, {
   3.457766288098695*^9, 3.4577662961015263`*^9}, {3.457766376541007*^9, 
   3.457766430598283*^9}, 3.45777528180894*^9, 3.457775329784709*^9, 
   3.457775437612252*^9, {3.457775542547876*^9, 3.457775563112082*^9}, 
   3.45777686566667*^9, 3.457777093852912*^9, 3.457777629905952*^9, 
   3.4577777533915462`*^9, 3.457784327601109*^9, 3.457784364562419*^9, 
   3.457784777524827*^9, 3.457784822524694*^9, 3.457784858657956*^9, 
   3.457784890228799*^9, 3.4577850636486197`*^9, 3.457785133258576*^9, 
   3.457786572212881*^9, 3.457797804994872*^9, 3.4577978754075527`*^9, 
   3.457798266351853*^9, {3.457798519973571*^9, 3.457798572023304*^9}, {
   3.457798617558625*^9, 3.457798655146844*^9}, {3.457798746089346*^9, 
   3.4577987925980263`*^9}, 3.457798862699251*^9, 3.457845111560184*^9, {
   3.457849393672876*^9, 3.457849415116304*^9}, 3.457862387080812*^9, 
   3.457953374660802*^9, 3.4579536928480387`*^9, 3.457953783353417*^9, {
   3.457953930825058*^9, 3.4579539787494087`*^9}, 3.45795557751262*^9, 
   3.458289494485825*^9, 3.458289544364788*^9, 3.458292628927474*^9, 
   3.458624223698524*^9, 3.4586260388802147`*^9, {3.458626524060822*^9, 
   3.4586265878643923`*^9}, 3.4588188464666357`*^9, {3.458884232740313*^9, 
   3.4588842398055*^9}, 3.4590935460186567`*^9, {3.459093900626391*^9, 
   3.459093915288414*^9}, {3.459093956404031*^9, 3.459093972305007*^9}, 
   3.459839031489561*^9, {3.4598390776600246`*^9, 3.459839092861931*^9}, 
   3.459932973635069*^9, {3.46011883815723*^9, 3.4601188429883738`*^9}, 
   3.460118876122985*^9, {3.460118920345813*^9, 3.460118948301528*^9}, 
   3.460120519932987*^9, 3.4601211146621113`*^9, {3.460121299758052*^9, 
   3.460121328988152*^9}, 3.4601232522813396`*^9, 3.460124774976021*^9, 
   3.460124874837412*^9, {3.460127462720879*^9, 3.460127479430533*^9}, 
   3.460393801159984*^9, 3.4603939469577713`*^9, 3.460441548118229*^9, 
   3.460812359118882*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.457525963954905*^9, 3.457525988058708*^9}, {
   3.4575260469837723`*^9, 3.457526071702159*^9}, 3.457526103652482*^9, {
   3.4575262076547813`*^9, 3.457526237022325*^9}, 3.4575262710644627`*^9, {
   3.457526393361498*^9, 3.4575264199736967`*^9}, 3.457526489364911*^9, {
   3.457526548514436*^9, 3.45752656446655*^9}, 3.457526614290103*^9, 
   3.45752668525624*^9, {3.4575267241454563`*^9, 3.457526738136475*^9}, 
   3.457528362665086*^9, 3.45752839693546*^9, 3.4575284319968443`*^9, 
   3.457528517716673*^9, {3.457528588209323*^9, 3.457528617695696*^9}, 
   3.457532494342081*^9, 3.457534897277375*^9, {3.4575349378832493`*^9, 
   3.4575349804387093`*^9}, {3.4575350284661493`*^9, 3.457535085954796*^9}, 
   3.457593014857099*^9, {3.457616063575787*^9, 3.457616084323604*^9}, {
   3.457616127254602*^9, 3.457616131498653*^9}, 3.457761134485507*^9, 
   3.457761194420431*^9, 3.457761434465074*^9, 3.4577618119392157`*^9, {
   3.457764561146598*^9, 3.4577645734289494`*^9}, {3.4577646571758747`*^9, 
   3.457764679772084*^9}, 3.45776471285743*^9, {3.457764743683632*^9, 
   3.457764768990488*^9}, 3.457764919481948*^9, {3.457765484558496*^9, 
   3.4577655073946257`*^9}, 3.457765728639798*^9, {3.457765767734953*^9, 
   3.4577657854578457`*^9}, {3.457765826725992*^9, 3.457765835609083*^9}, {
   3.4577661738508387`*^9, 3.4577662002369204`*^9}, 3.4577662470731907`*^9, {
   3.457766288098695*^9, 3.4577662961015263`*^9}, {3.457766376541007*^9, 
   3.457766430598283*^9}, 3.45777528180894*^9, 3.457775329784709*^9, 
   3.457775437612252*^9, {3.457775542547876*^9, 3.457775563112082*^9}, 
   3.45777686566667*^9, 3.457777093852912*^9, 3.457777629905952*^9, 
   3.4577777533915462`*^9, 3.457784327601109*^9, 3.457784364562419*^9, 
   3.457784777524827*^9, 3.457784822524694*^9, 3.457784858657956*^9, 
   3.457784890228799*^9, 3.4577850636486197`*^9, 3.457785133258576*^9, 
   3.457786572212881*^9, 3.457797804994872*^9, 3.4577978754075527`*^9, 
   3.457798266351853*^9, {3.457798519973571*^9, 3.457798572023304*^9}, {
   3.457798617558625*^9, 3.457798655146844*^9}, {3.457798746089346*^9, 
   3.4577987925980263`*^9}, 3.457798862699251*^9, 3.457845111560184*^9, {
   3.457849393672876*^9, 3.457849415116304*^9}, 3.457862387080812*^9, 
   3.457953374660802*^9, 3.4579536928480387`*^9, 3.457953783353417*^9, {
   3.457953930825058*^9, 3.4579539787494087`*^9}, 3.45795557751262*^9, 
   3.458289494485825*^9, 3.458289544364788*^9, 3.458292628927474*^9, 
   3.458624223698524*^9, 3.4586260388802147`*^9, {3.458626524060822*^9, 
   3.4586265878643923`*^9}, 3.4588188464666357`*^9, {3.458884232740313*^9, 
   3.4588842398055*^9}, 3.4590935460186567`*^9, {3.459093900626391*^9, 
   3.459093915288414*^9}, {3.459093956404031*^9, 3.459093972305007*^9}, 
   3.459839031489561*^9, {3.4598390776600246`*^9, 3.459839092861931*^9}, 
   3.459932973635069*^9, {3.46011883815723*^9, 3.4601188429883738`*^9}, 
   3.460118876122985*^9, {3.460118920345813*^9, 3.460118948301528*^9}, 
   3.460120519932987*^9, 3.4601211146621113`*^9, {3.460121299758052*^9, 
   3.460121328988152*^9}, 3.4601232522813396`*^9, 3.460124774976021*^9, 
   3.460124874837412*^9, {3.460127462720879*^9, 3.460127479430533*^9}, 
   3.460393801159984*^9, 3.4603939469577713`*^9, 3.460441548118229*^9, 
   3.460812359128192*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.457525963954905*^9, 3.457525988058708*^9}, {
   3.4575260469837723`*^9, 3.457526071702159*^9}, 3.457526103652482*^9, {
   3.4575262076547813`*^9, 3.457526237022325*^9}, 3.4575262710644627`*^9, {
   3.457526393361498*^9, 3.4575264199736967`*^9}, 3.457526489364911*^9, {
   3.457526548514436*^9, 3.45752656446655*^9}, 3.457526614290103*^9, 
   3.45752668525624*^9, {3.4575267241454563`*^9, 3.457526738136475*^9}, 
   3.457528362665086*^9, 3.45752839693546*^9, 3.4575284319968443`*^9, 
   3.457528517716673*^9, {3.457528588209323*^9, 3.457528617695696*^9}, 
   3.457532494342081*^9, 3.457534897277375*^9, {3.4575349378832493`*^9, 
   3.4575349804387093`*^9}, {3.4575350284661493`*^9, 3.457535085954796*^9}, 
   3.457593014857099*^9, {3.457616063575787*^9, 3.457616084323604*^9}, {
   3.457616127254602*^9, 3.457616131498653*^9}, 3.457761134485507*^9, 
   3.457761194420431*^9, 3.457761434465074*^9, 3.4577618119392157`*^9, {
   3.457764561146598*^9, 3.4577645734289494`*^9}, {3.4577646571758747`*^9, 
   3.457764679772084*^9}, 3.45776471285743*^9, {3.457764743683632*^9, 
   3.457764768990488*^9}, 3.457764919481948*^9, {3.457765484558496*^9, 
   3.4577655073946257`*^9}, 3.457765728639798*^9, {3.457765767734953*^9, 
   3.4577657854578457`*^9}, {3.457765826725992*^9, 3.457765835609083*^9}, {
   3.4577661738508387`*^9, 3.4577662002369204`*^9}, 3.4577662470731907`*^9, {
   3.457766288098695*^9, 3.4577662961015263`*^9}, {3.457766376541007*^9, 
   3.457766430598283*^9}, 3.45777528180894*^9, 3.457775329784709*^9, 
   3.457775437612252*^9, {3.457775542547876*^9, 3.457775563112082*^9}, 
   3.45777686566667*^9, 3.457777093852912*^9, 3.457777629905952*^9, 
   3.4577777533915462`*^9, 3.457784327601109*^9, 3.457784364562419*^9, 
   3.457784777524827*^9, 3.457784822524694*^9, 3.457784858657956*^9, 
   3.457784890228799*^9, 3.4577850636486197`*^9, 3.457785133258576*^9, 
   3.457786572212881*^9, 3.457797804994872*^9, 3.4577978754075527`*^9, 
   3.457798266351853*^9, {3.457798519973571*^9, 3.457798572023304*^9}, {
   3.457798617558625*^9, 3.457798655146844*^9}, {3.457798746089346*^9, 
   3.4577987925980263`*^9}, 3.457798862699251*^9, 3.457845111560184*^9, {
   3.457849393672876*^9, 3.457849415116304*^9}, 3.457862387080812*^9, 
   3.457953374660802*^9, 3.4579536928480387`*^9, 3.457953783353417*^9, {
   3.457953930825058*^9, 3.4579539787494087`*^9}, 3.45795557751262*^9, 
   3.458289494485825*^9, 3.458289544364788*^9, 3.458292628927474*^9, 
   3.458624223698524*^9, 3.4586260388802147`*^9, {3.458626524060822*^9, 
   3.4586265878643923`*^9}, 3.4588188464666357`*^9, {3.458884232740313*^9, 
   3.4588842398055*^9}, 3.4590935460186567`*^9, {3.459093900626391*^9, 
   3.459093915288414*^9}, {3.459093956404031*^9, 3.459093972305007*^9}, 
   3.459839031489561*^9, {3.4598390776600246`*^9, 3.459839092861931*^9}, 
   3.459932973635069*^9, {3.46011883815723*^9, 3.4601188429883738`*^9}, 
   3.460118876122985*^9, {3.460118920345813*^9, 3.460118948301528*^9}, 
   3.460120519932987*^9, 3.4601211146621113`*^9, {3.460121299758052*^9, 
   3.460121328988152*^9}, 3.4601232522813396`*^9, 3.460124774976021*^9, 
   3.460124874837412*^9, {3.460127462720879*^9, 3.460127479430533*^9}, 
   3.460393801159984*^9, 3.4603939469577713`*^9, 3.460441548118229*^9, 
   3.460812359150535*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.457525963954905*^9, 3.457525988058708*^9}, {
   3.4575260469837723`*^9, 3.457526071702159*^9}, 3.457526103652482*^9, {
   3.4575262076547813`*^9, 3.457526237022325*^9}, 3.4575262710644627`*^9, {
   3.457526393361498*^9, 3.4575264199736967`*^9}, 3.457526489364911*^9, {
   3.457526548514436*^9, 3.45752656446655*^9}, 3.457526614290103*^9, 
   3.45752668525624*^9, {3.4575267241454563`*^9, 3.457526738136475*^9}, 
   3.457528362665086*^9, 3.45752839693546*^9, 3.4575284319968443`*^9, 
   3.457528517716673*^9, {3.457528588209323*^9, 3.457528617695696*^9}, 
   3.457532494342081*^9, 3.457534897277375*^9, {3.4575349378832493`*^9, 
   3.4575349804387093`*^9}, {3.4575350284661493`*^9, 3.457535085954796*^9}, 
   3.457593014857099*^9, {3.457616063575787*^9, 3.457616084323604*^9}, {
   3.457616127254602*^9, 3.457616131498653*^9}, 3.457761134485507*^9, 
   3.457761194420431*^9, 3.457761434465074*^9, 3.4577618119392157`*^9, {
   3.457764561146598*^9, 3.4577645734289494`*^9}, {3.4577646571758747`*^9, 
   3.457764679772084*^9}, 3.45776471285743*^9, {3.457764743683632*^9, 
   3.457764768990488*^9}, 3.457764919481948*^9, {3.457765484558496*^9, 
   3.4577655073946257`*^9}, 3.457765728639798*^9, {3.457765767734953*^9, 
   3.4577657854578457`*^9}, {3.457765826725992*^9, 3.457765835609083*^9}, {
   3.4577661738508387`*^9, 3.4577662002369204`*^9}, 3.4577662470731907`*^9, {
   3.457766288098695*^9, 3.4577662961015263`*^9}, {3.457766376541007*^9, 
   3.457766430598283*^9}, 3.45777528180894*^9, 3.457775329784709*^9, 
   3.457775437612252*^9, {3.457775542547876*^9, 3.457775563112082*^9}, 
   3.45777686566667*^9, 3.457777093852912*^9, 3.457777629905952*^9, 
   3.4577777533915462`*^9, 3.457784327601109*^9, 3.457784364562419*^9, 
   3.457784777524827*^9, 3.457784822524694*^9, 3.457784858657956*^9, 
   3.457784890228799*^9, 3.4577850636486197`*^9, 3.457785133258576*^9, 
   3.457786572212881*^9, 3.457797804994872*^9, 3.4577978754075527`*^9, 
   3.457798266351853*^9, {3.457798519973571*^9, 3.457798572023304*^9}, {
   3.457798617558625*^9, 3.457798655146844*^9}, {3.457798746089346*^9, 
   3.4577987925980263`*^9}, 3.457798862699251*^9, 3.457845111560184*^9, {
   3.457849393672876*^9, 3.457849415116304*^9}, 3.457862387080812*^9, 
   3.457953374660802*^9, 3.4579536928480387`*^9, 3.457953783353417*^9, {
   3.457953930825058*^9, 3.4579539787494087`*^9}, 3.45795557751262*^9, 
   3.458289494485825*^9, 3.458289544364788*^9, 3.458292628927474*^9, 
   3.458624223698524*^9, 3.4586260388802147`*^9, {3.458626524060822*^9, 
   3.4586265878643923`*^9}, 3.4588188464666357`*^9, {3.458884232740313*^9, 
   3.4588842398055*^9}, 3.4590935460186567`*^9, {3.459093900626391*^9, 
   3.459093915288414*^9}, {3.459093956404031*^9, 3.459093972305007*^9}, 
   3.459839031489561*^9, {3.4598390776600246`*^9, 3.459839092861931*^9}, 
   3.459932973635069*^9, {3.46011883815723*^9, 3.4601188429883738`*^9}, 
   3.460118876122985*^9, {3.460118920345813*^9, 3.460118948301528*^9}, 
   3.460120519932987*^9, 3.4601211146621113`*^9, {3.460121299758052*^9, 
   3.460121328988152*^9}, 3.4601232522813396`*^9, 3.460124774976021*^9, 
   3.460124874837412*^9, {3.460127462720879*^9, 3.460127479430533*^9}, 
   3.460393801159984*^9, 3.4603939469577713`*^9, 3.460441548118229*^9, 
   3.4608123591642036`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.457350326402195*^9, 3.457350327757354*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"BeginPackage", "[", 
  RowBox[{"\"\<Niko`\>\"", ",", 
   RowBox[{"{", "\"\<Combinatorica`\>\"", "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "\[Rho]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"score", "::", "usage"}], "=", " ", 
   "\"\<The score of a potential solution\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectMaximizer", "::", "usage"}], "=", " ", 
   "\"\<list, weight function\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateSwapInstance", "::", "usage"}], "=", 
   "\"\<what it says\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "::", "usage"}], " ", "=", " ", "\"\<gee!\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectAny", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalRho]", "::", "usage"}], " ", "=", " ", "\"\<\>\""}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Lambda]_", "\[VerticalSeparator]", " ", "d_"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"\[Lambda]", ",", 
          RowBox[{
           RowBox[{"#", "\[NotEqual]", " ", "d"}], "&"}]}], "]"}]}], " ", 
       "}"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", ">", "d"}], ",", 
          RowBox[{"#", "-", "1"}], ",", "#"}], "]"}], "&"}], "/@", " ", 
       "r"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]_", "\[VerticalSeparator]", " ", "d_"}], " ", ":=", " ", 
  RowBox[{"sep", "[", 
   RowBox[{"\[Lambda]", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sep", "=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", ",", "_Integer", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"\[Lambda]", ",", 
           RowBox[{
            RowBox[{"#", "\[NotEqual]", " ", "d"}], "&"}]}], "]"}]}], " ", 
        "}"}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", ">", "d"}], ",", 
           RowBox[{"#", "-", "1"}], ",", "#"}], "]"}], "&"}], "/@", " ", 
        "r"}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Select", "[", "__", "]"}], ",", "_Integer", ",", "1"}], 
       "}"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sep", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "2"}], "]"}], "\[Equal]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[Rho]", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"\[Rho]", "=", 
    RowBox[{
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Lambda]", ",", "_Integer", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"d", ",", "_Integer"}], "}"}]}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", "\[GreaterEqual]", " ", "d"}], ",", 
           RowBox[{"#", "+", "1"}], ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
        "\[Lambda]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
     
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]", "=", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "}"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\[Rho]", "[", 
          RowBox[{
           RowBox[{"\[Lambda]", "\[VerticalSeparator]", "1"}], ",", "1"}], 
          "]"}], "]"}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Lambda]", "\[VerticalSeparator]", "1"}], ")"}], " ", "==", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "\[And]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Rho]", "[", 
           RowBox[{
            RowBox[{"\[Lambda]", "\[VerticalSeparator]", "1"}], ",", "1"}], 
           "]"}], "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{"2", ",", "4", ",", "3"}], "}"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Rho]", "[", 
     RowBox[{"\[Lambda]_List", ",", "d_"}], "]"}], ":=", " ", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{"\[Lambda]", ",", 
      RowBox[{
       RowBox[{"j_Integer", " ", "/;", 
        RowBox[{"j", "\[GreaterEqual]", " ", "d"}]}], "\[Rule]", "  ", 
       RowBox[{"j", "+", "1"}]}]}], "]"}]}], "*)"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "[", 
    RowBox[{"\[Lambda]_List", ",", "d_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", "\[GreaterEqual]", " ", "d"}], ",", 
       RowBox[{"#", "+", "1"}], ",", "#"}], "]"}], "&"}], "/@", " ", 
    "\[Lambda]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "score", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"score", " ", "=", " ", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"perm", ",", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"max", "=", 
         RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Scan", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"p", ",", 
            RowBox[{"max", "=", 
             RowBox[{"Max", "[", 
              RowBox[{"max", ",", 
               RowBox[{"tau", "[", 
                RowBox[{"perm", ",", "p"}], "]"}]}], "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", "Global`inp"}], "\[IndentingNewLine]", "]"}],
         ";", "max"}]}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Tau]", "[", "___", "]"}], ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tau", "[", "___", "]"}], ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"max", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Max", "[", "___", "]"}], ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Global`inp", ",", "_Integer", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Map", "[", "___", "]"}], ",", "_Integer", ",", "1"}], 
        "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectAny", "[", 
   RowBox[{"list_List", ",", "criterion_"}], "]"}], ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Catch", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Scan", "[", " ", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"criterion", "[", "#", "]"}], ",", 
          RowBox[{"Throw", "[", 
           RowBox[{"#", ",", "\"\<result\>\""}], "]"}]}], "]"}], "&"}], 
       "\[IndentingNewLine]", ",", "list"}], "\[IndentingNewLine]", "]"}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Throw", "[", "\"\<No such element\>\"", "]"}]}], 
    "\[IndentingNewLine]", ",", "\"\<result\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectAny", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
     "OddQ"}], "]"}], "\[Equal]", " ", "1"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Schwartzian", " ", "Transformation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "SelectMaximizer", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SelectMaximizer", "[", 
   RowBox[{"list_List", ",", "weight_"}], "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "max"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"weight", "[", "#", "]"}]}], "}"}], "&"}], " ", "/@", " ", 
       "list"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"max", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", " ", "a"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SelectAny", "[", 
       RowBox[{"a", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", " ", "max"}], "&"}]}], 
       "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectMaximizer", "[", 
    RowBox[{
     RowBox[{"Range", "[", "10", "]"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#", "\[Equal]", " ", "4"}], ",", "1", ",", "0"}], "]"}], 
      "&"}]}], "]"}], "\[Equal]", "4"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"\[CapitalRho]rec", ",", "\[CapitalRho]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalRho]", "[", "l_List", "]"}], ":=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"\[CapitalRho]rec", "[", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Flatten", "[", "l", "]"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalRho]rec", "[", "\[Nu]_List", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "\[Nu]"}], "\[Equal]", "1"}], ",", "\[Nu]", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "[", "\[Nu]", "]"}], ",", 
          RowBox[{"\[Rho]", "[", 
           RowBox[{
            RowBox[{"\[CapitalRho]rec", "[", 
             RowBox[{"Rest", "[", "\[Nu]", "]"}], "]"}], ",", 
            RowBox[{"First", "[", "\[Nu]", "]"}]}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalRho]rec", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "\[Nu]"}], "\[Equal]", "1"}], ",", "\[Nu]", 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"\[Rho]", "[", 
             RowBox[{
              RowBox[{"\[CapitalRho]rec", "[", 
               RowBox[{"Rest", "[", "\[Nu]", "]"}], "]"}], ",", 
              RowBox[{"First", "[", "\[Nu]", "]"}]}], "]"}], ",", 
            RowBox[{"First", "@", "\[Nu]"}]}], "]"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "___", "]"}], ",", "_Integer"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "[", "___", "]"}], ",", "_Integer"}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Rest", "@", "___"}], ",", " ", "_Integer", ",", "1"}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[CapitalRho]rec", "[", "___", "]"}], ",", "_Integer", ",",
           "1"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Rho]", "[", "___", "]"}], ",", "_Integer", ",", "1"}], 
         "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalRho]", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "2"}], "}"}], "]"}], " ", "\[Equal]", " ", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "CreateSwapInstance", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateSwapInstance", "[", 
   RowBox[{
    RowBox[{"n_:", "5"}], ",", " ", 
    RowBox[{"m_:", "5"}]}], "]"}], " ", ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Global`inp", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RandomPermutation", "[", "n", "]"}], ",", 
        RowBox[{"{", "m", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Global`input", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", "q"}], "}"}], "&"}], "/@", "Global`inp"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Global`R", "=", 
      RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{"\"\<niko.mx\>\"", ",", "\"\<Niko`\>\""}], "]"}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.457165056974057*^9, 3.4571650653864317`*^9}, {
   3.4571651083501177`*^9, 3.457165140415986*^9}, {3.457165190658949*^9, 
   3.457165214892494*^9}, {3.4571653113056993`*^9, 3.457165315213135*^9}, {
   3.457165986727325*^9, 3.457166071956218*^9}, {3.457186723142535*^9, 
   3.4571867357638063`*^9}, {3.457186829574153*^9, 3.457186870675481*^9}, {
   3.457186912858976*^9, 3.457186915377759*^9}, {3.457188394782494*^9, 
   3.457188401450893*^9}, {3.457255407150695*^9, 3.457255558820833*^9}, {
   3.457451861239925*^9, 3.4574518647732277`*^9}, {3.457525102592218*^9, 
   3.45752522063654*^9}, {3.4575252603877907`*^9, 3.4575252809385147`*^9}, {
   3.4576161562527933`*^9, 3.457616156340266*^9}, {3.4577625622987213`*^9, 
   3.457762597108272*^9}, {3.457784485364245*^9, 3.457784519790126*^9}, {
   3.457784627677067*^9, 3.4577846322368383`*^9}, {3.4577849145021067`*^9, 
   3.4577849878238583`*^9}, {3.457785030579536*^9, 3.4577850425310698`*^9}, {
   3.4577850777407427`*^9, 3.4577851277294083`*^9}, {3.457797867793542*^9, 
   3.457797868279635*^9}, {3.457797916750867*^9, 3.457797917538354*^9}, {
   3.457797976799844*^9, 3.4577979832869663`*^9}, {3.457798013573064*^9, 
   3.4577980140360727`*^9}, {3.457862426591009*^9, 3.4578624316744633`*^9}, {
   3.4578747027240143`*^9, 3.4578747667154417`*^9}, {3.4578749867059526`*^9, 
   3.457874991907423*^9}, {3.4598372695335817`*^9, 3.459837270453333*^9}, {
   3.4598373978697844`*^9, 3.459837710098301*^9}, {3.459838714282247*^9, 
   3.45983876051925*^9}, {3.45993345881678*^9, 3.4599334769866657`*^9}, {
   3.45993356481846*^9, 3.459933565354239*^9}, {3.459933613323717*^9, 
   3.459933614924909*^9}, {3.459937645492923*^9, 3.459937646873228*^9}, {
   3.460119786078183*^9, 3.460119888974465*^9}, {3.4601199255095997`*^9, 
   3.460119928914117*^9}, {3.460119981049851*^9, 3.460120010814392*^9}, {
   3.46012007125314*^9, 3.460120269021989*^9}, 3.460120567974505*^9, {
   3.460121135327567*^9, 3.4601211386344547`*^9}, 3.4601224553722067`*^9, {
   3.460122733357779*^9, 3.460122734447101*^9}, {3.4601230483656273`*^9, 
   3.4601231033244867`*^9}, {3.460123291951502*^9, 3.4601233261545963`*^9}, {
   3.460123926682743*^9, 3.460123947277443*^9}, {3.460124044152927*^9, 
   3.460124048130348*^9}, {3.460124300146957*^9, 3.4601243343835907`*^9}, {
   3.460124718265129*^9, 3.460124718903079*^9}, 3.460124927973872*^9, {
   3.460124994929072*^9, 3.4601250281702843`*^9}, {3.46012511949827*^9, 
   3.4601251301088533`*^9}, {3.460393073332178*^9, 3.4603932851118717`*^9}, {
   3.460393364592698*^9, 3.4603933859568768`*^9}, {3.460393600329171*^9, 
   3.460393625083359*^9}, {3.4603940205329723`*^9, 3.460394107087202*^9}}],

Cell[BoxData["\<\"Niko`\"\>"], "Output",
 CellChangeTimes->{
  3.4578623799081306`*^9, 3.4578624321057673`*^9, 3.457874773164566*^9, 
   3.4578749929665623`*^9, 3.457953133464814*^9, 3.457953180121007*^9, 
   3.457953268671311*^9, {3.457953921694319*^9, 3.457953924248641*^9}, 
   3.458289333427305*^9, 3.4582902220498047`*^9, 3.458624216998458*^9, 
   3.458818843845277*^9, 3.45928565277803*^9, 3.459320694609316*^9, {
   3.459837677711506*^9, 3.4598377113736362`*^9}, {3.459838749782826*^9, 
   3.459838761442273*^9}, 3.459839090456669*^9, 3.4599330892685204`*^9, 
   3.459933478240715*^9, 3.459933566698567*^9, 3.4599336156430283`*^9, 
   3.459937660541473*^9, {3.460119869316832*^9, 3.460119889550865*^9}, 
   3.4601200114768972`*^9, 3.460120207385437*^9, 3.4601202405611134`*^9, 
   3.460121143758624*^9, 3.4601227637913113`*^9, 3.4601228102804003`*^9, {
   3.460123063297051*^9, 3.460123087416744*^9}, {3.460123298382421*^9, 
   3.46012333671417*^9}, 3.460124306394785*^9, 3.460124719988243*^9, 
   3.460124898123288*^9, 3.460124929068284*^9, {3.46012500200045*^9, 
   3.460125028910042*^9}, {3.4601251216909533`*^9, 3.460125130787973*^9}, 
   3.4601274743204937`*^9, 3.4603930792631407`*^9, {3.4603932647739687`*^9, 
   3.4603932857910624`*^9}, 3.460393389121397*^9, 3.460393626131773*^9, {
   3.460394079670786*^9, 3.460394107561124*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.4578623799081306`*^9, 3.4578624321057673`*^9, 3.457874773164566*^9, 
   3.4578749929665623`*^9, 3.457953133464814*^9, 3.457953180121007*^9, 
   3.457953268671311*^9, {3.457953921694319*^9, 3.457953924248641*^9}, 
   3.458289333427305*^9, 3.4582902220498047`*^9, 3.458624216998458*^9, 
   3.458818843845277*^9, 3.45928565277803*^9, 3.459320694609316*^9, {
   3.459837677711506*^9, 3.4598377113736362`*^9}, {3.459838749782826*^9, 
   3.459838761442273*^9}, 3.459839090456669*^9, 3.4599330892685204`*^9, 
   3.459933478240715*^9, 3.459933566698567*^9, 3.4599336156430283`*^9, 
   3.459937660541473*^9, {3.460119869316832*^9, 3.460119889550865*^9}, 
   3.4601200114768972`*^9, 3.460120207385437*^9, 3.4601202405611134`*^9, 
   3.460121143758624*^9, 3.4601227637913113`*^9, 3.4601228102804003`*^9, {
   3.460123063297051*^9, 3.460123087416744*^9}, {3.460123298382421*^9, 
   3.46012333671417*^9}, 3.460124306394785*^9, 3.460124719988243*^9, 
   3.460124898123288*^9, 3.460124929068284*^9, {3.46012500200045*^9, 
   3.460125028910042*^9}, {3.4601251216909533`*^9, 3.460125130787973*^9}, 
   3.4601274743204937`*^9, 3.4603930792631407`*^9, {3.4603932647739687`*^9, 
   3.4603932857910624`*^9}, 3.460393389121397*^9, 3.460393626131773*^9, {
   3.460394079670786*^9, 3.460394107585259*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.4578623799081306`*^9, 3.4578624321057673`*^9, 3.457874773164566*^9, 
   3.4578749929665623`*^9, 3.457953133464814*^9, 3.457953180121007*^9, 
   3.457953268671311*^9, {3.457953921694319*^9, 3.457953924248641*^9}, 
   3.458289333427305*^9, 3.4582902220498047`*^9, 3.458624216998458*^9, 
   3.458818843845277*^9, 3.45928565277803*^9, 3.459320694609316*^9, {
   3.459837677711506*^9, 3.4598377113736362`*^9}, {3.459838749782826*^9, 
   3.459838761442273*^9}, 3.459839090456669*^9, 3.4599330892685204`*^9, 
   3.459933478240715*^9, 3.459933566698567*^9, 3.4599336156430283`*^9, 
   3.459937660541473*^9, {3.460119869316832*^9, 3.460119889550865*^9}, 
   3.4601200114768972`*^9, 3.460120207385437*^9, 3.4601202405611134`*^9, 
   3.460121143758624*^9, 3.4601227637913113`*^9, 3.4601228102804003`*^9, {
   3.460123063297051*^9, 3.460123087416744*^9}, {3.460123298382421*^9, 
   3.46012333671417*^9}, 3.460124306394785*^9, 3.460124719988243*^9, 
   3.460124898123288*^9, 3.460124929068284*^9, {3.46012500200045*^9, 
   3.460125028910042*^9}, {3.4601251216909533`*^9, 3.460125130787973*^9}, 
   3.4601274743204937`*^9, 3.4603930792631407`*^9, {3.4603932647739687`*^9, 
   3.4603932857910624`*^9}, 3.460393389121397*^9, 3.460393626131773*^9, {
   3.460394079670786*^9, 3.460394107601177*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.4578623799081306`*^9, 3.4578624321057673`*^9, 3.457874773164566*^9, 
   3.4578749929665623`*^9, 3.457953133464814*^9, 3.457953180121007*^9, 
   3.457953268671311*^9, {3.457953921694319*^9, 3.457953924248641*^9}, 
   3.458289333427305*^9, 3.4582902220498047`*^9, 3.458624216998458*^9, 
   3.458818843845277*^9, 3.45928565277803*^9, 3.459320694609316*^9, {
   3.459837677711506*^9, 3.4598377113736362`*^9}, {3.459838749782826*^9, 
   3.459838761442273*^9}, 3.459839090456669*^9, 3.4599330892685204`*^9, 
   3.459933478240715*^9, 3.459933566698567*^9, 3.4599336156430283`*^9, 
   3.459937660541473*^9, {3.460119869316832*^9, 3.460119889550865*^9}, 
   3.4601200114768972`*^9, 3.460120207385437*^9, 3.4601202405611134`*^9, 
   3.460121143758624*^9, 3.4601227637913113`*^9, 3.4601228102804003`*^9, {
   3.460123063297051*^9, 3.460123087416744*^9}, {3.460123298382421*^9, 
   3.46012333671417*^9}, 3.460124306394785*^9, 3.460124719988243*^9, 
   3.460124898123288*^9, 3.460124929068284*^9, {3.46012500200045*^9, 
   3.460125028910042*^9}, {3.4601251216909533`*^9, 3.460125130787973*^9}, 
   3.4601274743204937`*^9, 3.4603930792631407`*^9, {3.4603932647739687`*^9, 
   3.4603932857910624`*^9}, 3.460393389121397*^9, 3.460393626131773*^9, {
   3.460394079670786*^9, 3.4603941076192303`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.4578623799081306`*^9, 3.4578624321057673`*^9, 3.457874773164566*^9, 
   3.4578749929665623`*^9, 3.457953133464814*^9, 3.457953180121007*^9, 
   3.457953268671311*^9, {3.457953921694319*^9, 3.457953924248641*^9}, 
   3.458289333427305*^9, 3.4582902220498047`*^9, 3.458624216998458*^9, 
   3.458818843845277*^9, 3.45928565277803*^9, 3.459320694609316*^9, {
   3.459837677711506*^9, 3.4598377113736362`*^9}, {3.459838749782826*^9, 
   3.459838761442273*^9}, 3.459839090456669*^9, 3.4599330892685204`*^9, 
   3.459933478240715*^9, 3.459933566698567*^9, 3.4599336156430283`*^9, 
   3.459937660541473*^9, {3.460119869316832*^9, 3.460119889550865*^9}, 
   3.4601200114768972`*^9, 3.460120207385437*^9, 3.4601202405611134`*^9, 
   3.460121143758624*^9, 3.4601227637913113`*^9, 3.4601228102804003`*^9, {
   3.460123063297051*^9, 3.460123087416744*^9}, {3.460123298382421*^9, 
   3.46012333671417*^9}, 3.460124306394785*^9, 3.460124719988243*^9, 
   3.460124898123288*^9, 3.460124929068284*^9, {3.46012500200045*^9, 
   3.460125028910042*^9}, {3.4601251216909533`*^9, 3.460125130787973*^9}, 
   3.4601274743204937`*^9, 3.4603930792631407`*^9, {3.4603932647739687`*^9, 
   3.4603932857910624`*^9}, 3.460393389121397*^9, 3.460393626131773*^9, {
   3.460394079670786*^9, 3.460394107634419*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"intersection3All", "[", "inp", "]"}], "//", "Reap"}]], "Input",
 CellChangeTimes->{{3.45828961493885*^9, 3.458289624161021*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4", ",", "1", ",", "3", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "}"}]}], "}"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.4582896244738617`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Context", "[", "inp", "]"}]], "Input",
 CellChangeTimes->{{3.4599334987190733`*^9, 3.4599335017958183`*^9}}],

Cell[BoxData["\<\"Niko`\"\>"], "Output",
 CellChangeTimes->{3.459933502225527*^9, 3.459933582938498*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"Global`inp", "\[IndentingNewLine]", "input"}], "Input",
 CellChangeTimes->{{3.457845177305298*^9, 3.4578451775067053`*^9}, {
  3.4578747812448597`*^9, 3.457874782851684*^9}, {3.4599335081091423`*^9, 
  3.459933510496587*^9}, {3.459933598304908*^9, 3.459933603885777*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3", ",", "1", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5", ",", "4", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5", ",", "2", ",", "4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "5", ",", "4"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.4578451777913*^9, 3.457874783105919*^9, 3.457874815863804*^9, {
   3.457954360747957*^9, 3.457954370502605*^9}, 3.457954407770802*^9, 
   3.458289345714691*^9, 3.458289440514933*^9, {3.459933510788837*^9, 
   3.4599335325404577`*^9}, {3.4599335859921618`*^9, 3.459933634953767*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "2", ",", "5", ",", "4"}], "}"}], ",", 
     "q"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "3", ",", "1", ",", "4", ",", "2"}], "}"}], ",", 
     "q"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "5", ",", "4", ",", "1", ",", "3"}], "}"}], ",", 
     "q"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "5", ",", "2", ",", "4", ",", "1"}], "}"}], ",", 
     "q"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "1", ",", "2", ",", "5", ",", "4"}], "}"}], ",", 
     "q"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4578451777913*^9, 3.457874783105919*^9, 3.457874815863804*^9, {
   3.457954360747957*^9, 3.457954370502605*^9}, 3.457954407770802*^9, 
   3.458289345714691*^9, 3.458289440514933*^9, {3.459933510788837*^9, 
   3.4599335325404577`*^9}, {3.4599335859921618`*^9, 3.45993363495887*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"NPS", "[", "]"}], "//", "Timing"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"triv", "[", "]"}], "//", "Timing"}]}], "Input",
 CellChangeTimes->{{3.457874792359665*^9, 3.457874793592351*^9}, {
  3.457875012074031*^9, 3.4578750274866457`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8687160000000063`", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{
  3.457874807027955*^9, 3.457874855171385*^9, {3.457875002489793*^9, 
   3.457875045460513*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "2", ",", "5", ",", "1", ",", "4", ",", "3"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.457875045757208*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.29215599999992037`", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{
  3.457874807027955*^9, 3.457874855171385*^9, {3.457875002489793*^9, 
   3.457875045758308*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CreateSwapInstance", "[", 
  RowBox[{"3", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.457849498309052*^9, 3.457849510135606*^9}, 
   3.4578519111155653`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4578495066711817`*^9, 3.4578495113645353`*^9}, 
   3.45785191231669*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"triv", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"Timing", "[", 
   RowBox[{"intersection3", "[", "inp", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.4577629940397863`*^9, 3.457763002307433*^9}, {
   3.457763033869054*^9, 3.457763049357727*^9}, {3.4577630847423058`*^9, 
   3.457763104628214*^9}, 3.457763137496615*^9, {3.457785148447246*^9, 
   3.457785161346919*^9}, {3.457785204750308*^9, 3.457785204848261*^9}, 
   3.4577853062566442`*^9, {3.4577981409637127`*^9, 3.4577981418262177`*^9}, {
   3.4578005762497797`*^9, 3.457800605112646*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.72191500000008`", ",", "11"}], "}"}]], "Output",
 CellChangeTimes->{
  3.457763003468687*^9, {3.4577630358112307`*^9, 3.4577631406121798`*^9}, 
   3.457776829723751*^9, {3.4577771689740868`*^9, 3.457777186843882*^9}, 
   3.457784335376075*^9, 3.4577843704389973`*^9, {3.45778441670109*^9, 
   3.457784435611589*^9}, 3.457784528768013*^9, {3.4577851411685467`*^9, 
   3.457785164119768*^9}, 3.457785208113922*^9, 3.4577853269836063`*^9, 
   3.457798065978764*^9, {3.457800587807068*^9, 3.457800606029272*^9}, {
   3.457800645361988*^9, 3.4578006654254093`*^9}, 3.457800795383988*^9, 
   3.457801134077806*^9, 3.4578012000933523`*^9, 3.457802108285162*^9, 
   3.45780243433788*^9, 3.457802618169086*^9, 3.457803039920829*^9, 
   3.457803071198872*^9, 3.4578494376710787`*^9, 3.4578495310448914`*^9, 
   3.457851838823398*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7680900000000292`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "4", ",", "2", ",", "8", ",", "3", ",", "7", ",", "1", ",", "6", ",", 
       "5"}], "}"}], ",", "11"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.457763003468687*^9, {3.4577630358112307`*^9, 3.4577631406121798`*^9}, 
   3.457776829723751*^9, {3.4577771689740868`*^9, 3.457777186843882*^9}, 
   3.457784335376075*^9, 3.4577843704389973`*^9, {3.45778441670109*^9, 
   3.457784435611589*^9}, 3.457784528768013*^9, {3.4577851411685467`*^9, 
   3.457785164119768*^9}, 3.457785208113922*^9, 3.4577853269836063`*^9, 
   3.457798065978764*^9, {3.457800587807068*^9, 3.457800606029272*^9}, {
   3.457800645361988*^9, 3.4578006654254093`*^9}, 3.457800795383988*^9, 
   3.457801134077806*^9, 3.4578012000933523`*^9, 3.457802108285162*^9, 
   3.45780243433788*^9, 3.457802618169086*^9, 3.457803039920829*^9, 
   3.457803071198872*^9, 3.4578494376710787`*^9, 3.4578495310448914`*^9, 
   3.4578518396484327`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"int", "=", 
    RowBox[{"intersection2", "[", 
     RowBox[{"inp", ",", "21"}], "]"}]}], ";", " ", 
   RowBox[{"Min", "[", 
    RowBox[{"score", " ", "/@", " ", "int"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.457785333659553*^9, {3.457785460280702*^9, 3.457785460356021*^9}, {
   3.4577854919528637`*^9, 3.4577854978812037`*^9}, {3.457798177819257*^9, 
   3.457798182231821*^9}, {3.4577995289891653`*^9, 3.457799570730932*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"35.38618699999995`", ",", "22"}], "}"}]], "Output",
 CellChangeTimes->{
  3.4577853342240334`*^9, {3.457785461319983*^9, 3.457785498983357*^9}, {
   3.457798171708599*^9, 3.4577981831254473`*^9}, {3.45779949484697*^9, 
   3.457799567782888*^9}, 3.457799606993981*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Global`inp"], "Input",
 CellChangeTimes->{{3.46012277753307*^9, 3.4601227794635363`*^9}}],

Cell[BoxData["Global`inp"], "Output",
 CellChangeTimes->{3.460122779814334*^9, 3.460122922368599*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"intersection", ",", "intersectionGen"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intersection", "[", 
    RowBox[{"\[Lambda]_List", ",", "r_Integer", ",", 
     RowBox[{"ilam_Integer:", "0"}], ",", 
     RowBox[{"i1_Integer:", "0"}], ",", 
     RowBox[{"pos_Integer:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Reap", "[", 
        RowBox[{"intersectionGen", "[", 
         RowBox[{
         "\[Lambda]", ",", "r", ",", "Sow", ",", "ilam", ",", "i1", ",", 
          "pos"}], "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intersectionGen", "[", 
    RowBox[{"\[Lambda]_List", ",", "r_Integer", ",", "gen_", ",", 
     RowBox[{"ilam_Integer:", "0"}], ",", 
     RowBox[{"i1_Integer:", "0"}], ",", 
     RowBox[{"pos_Integer:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"Global`gen", "=", "gen"}], ";", " ", 
      RowBox[{"intersectionGenC", "[", 
       RowBox[{"\[Lambda]", ",", "r", ",", "ilam", ",", "i1", ",", "pos"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intersectionGenC", "=", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ",", "_Integer", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ilam", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"pos", ",", "_Integer"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "=", 
           RowBox[{"Length", "[", "\[Lambda]", "]"}]}], ",", "DD", ",", 
          RowBox[{"li", "=", " ", 
           RowBox[{"InversePermutation", "[", "\[Lambda]", "]"}]}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pos", "\[Equal]", "1"}], ",", 
           RowBox[{"\[Nu]", "=", 
            RowBox[{"Table", "[", 
             RowBox[{"Null", ",", 
              RowBox[{"{", 
               RowBox[{"Length", "@", "\[Lambda]"}], "}"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Abort", " ", "conditions"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{
             RowBox[{"tau", "[", 
              RowBox[{"\[Lambda]", ",", 
               RowBox[{"Range", "[", "n", "]"}]}], "]"}], "\[LessEqual]", " ", 
             RowBox[{"2", " ", "r"}]}], "]"}], ",", 
           RowBox[{"Throw", "[", 
            RowBox[{"\"\<There cannot be a solution\>\"", ",", 
             RowBox[{"intersection", "::", "noSolution"}]}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "\[Lambda]"}], "\[Equal]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Nu]", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "=", 
             RowBox[{"First", "@", "\[Lambda]"}]}], ";", 
            RowBox[{"Global`gen", "[", 
             RowBox[{"\[CapitalRho]", "@", "\[Nu]"}], "]"}], ";", 
            RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", "Execution", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"DD", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Range", "[", "n", "]"}], ",", 
            RowBox[{"Function", "[", 
             RowBox[{"d", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"li", "[", 
                   RowBox[{"[", "d", "]"}], "]"}], "-", "1", "+", 
                  RowBox[{"tau", "[", 
                   RowBox[{
                    RowBox[{"\[Lambda]", "\[VerticalSeparator]", "d"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}], "\[LessEqual]",
                  " ", 
                 RowBox[{
                  RowBox[{"2", " ", "r"}], " ", "-", " ", "ilam", "-", 
                  "i1"}]}], ")"}], "\[IndentingNewLine]", "\[And]", 
               RowBox[{
                RowBox[{"d", "-", "1"}], "\[LessEqual]", " ", 
                RowBox[{"r", "-", "i1"}]}], "\[And]", 
               RowBox[{
                RowBox[{
                 RowBox[{"li", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "-", "1"}], "\[LessEqual]", 
                " ", 
                RowBox[{"r", "-", "ilam"}]}]}]}], "\[IndentingNewLine]", 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Scan", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"d", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Nu]", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "pos"}], "]"}], "]"}], "=", "d"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"intersectionGenC", "[", 
               RowBox[{
                RowBox[{"\[Lambda]", "  ", "\[VerticalSeparator]", " ", "d"}],
                 ",", " ", "r", ",", 
                RowBox[{"ilam", "+", 
                 RowBox[{"li", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], "-", "1"}], ",", 
                RowBox[{"i1", "+", "d", "-", "1"}], ",", 
                RowBox[{"pos", "+", "1"}]}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], "\[IndentingNewLine]", ",", "DD"}], "\[IndentingNewLine]",
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", "_Integer"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"DD", ",", "_Integer", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"li", ",", "_Integer", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tau", "[", "___", "]"}], ",", "_Integer"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "___", "]"}], ",", "_Integer"}], "}"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"d", ",", "_Integer"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", "___", "]"}], ",", "_Integer", ",", "1"}], 
         "}"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "example", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"intersection", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "}"}], ",", "1"}], "]"}], 
    "\[Equal]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "}"}]}], "}"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intersection", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "}"}], ",", "1"}], "]"}], "==", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "}"}]}], "}"}]}]}], "Input",\

 CellChangeTimes->{{3.460361914393605*^9, 3.460361988721675*^9}, {
   3.4603910791526814`*^9, 3.460391201107102*^9}, {3.460391301138473*^9, 
   3.460391333717471*^9}, {3.460391392403681*^9, 3.460391459884451*^9}, {
   3.460391587967206*^9, 3.460391605509029*^9}, {3.460391671922085*^9, 
   3.460391697744197*^9}, {3.460391755994301*^9, 3.460391758861435*^9}, {
   3.4603918003366756`*^9, 3.4603918729305162`*^9}, {3.46039192091228*^9, 
   3.4603919589290123`*^9}, {3.460392072513651*^9, 3.460392238050035*^9}, {
   3.460392329424176*^9, 3.4603923590185957`*^9}, {3.460392423082945*^9, 
   3.460392430858336*^9}, {3.460392477688053*^9, 3.460392543171723*^9}, {
   3.460392578271214*^9, 3.4603926181174383`*^9}, {3.460392655696844*^9, 
   3.460392663487659*^9}, {3.46039269737714*^9, 3.460392867774976*^9}, {
   3.4603929088962297`*^9, 3.460392928268908*^9}, 3.4603937155809717`*^9, 
   3.46039416562796*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.460392868833345*^9, {3.460392910176358*^9, 3.4603929288390512`*^9}, 
   3.460393821209084*^9, 3.4603942681516647`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Global`gen"], "Input"],

Cell[BoxData["Sow"], "Output",
 CellChangeTimes->{3.4603924927165537`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalRho]", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "2"}], "}"}], "]"}], " ", "\[Equal]", " ", 
  RowBox[{"{", 
   RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalRho]", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"{", "}"}]}], "}"}]}], "}"}]}], "}"}], "]"}], " ", 
  "\[Equal]", " ", 
  RowBox[{"{", 
   RowBox[{"2", ",", "1", ",", "3"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.460356516810896*^9, 3.460356518585746*^9}, {
  3.460356583215589*^9, 3.4603565835034437`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.460356519272984*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", 
    RowBox[{"{", "2", "}"}]}], "}"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Rest", "[", "%", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Rest", "@", "%"}]}], "Input",
 CellChangeTimes->{{3.460356626425477*^9, 3.4603566592766743`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "2", "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.46035663946427*^9, 3.460356659787979*^9}}],

Cell[BoxData[
 RowBox[{"{", "2", "}"}]], "Output",
 CellChangeTimes->{{3.46035663946427*^9, 3.460356659789427*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"test", "[", "tab_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"tab", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "2"}], ";", "tab"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"test", "[", 
  RowBox[{"Table", "[", 
   RowBox[{"Null", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4603592382004633`*^9, 3.460359312765572*^9}, {
  3.4603593453584003`*^9, 3.460359377449379*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"setps\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\({Null, Null}\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" in the part assignment \
is not a symbol.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/setps\\\", ButtonNote -> \
\\\"Set::setps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.460359358201972*^9, 3.460359378013534*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.46035935820282*^9, 3.460359378015355*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tab", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"Null", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"test", "[", "tab", "]"}]}], "Input",
 CellChangeTimes->{{3.46036166205576*^9, 3.460361704838285*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"setps\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\({Null, Null}\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" in the part assignment \
is not a symbol.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/setps\\\", ButtonNote -> \
\\\"Set::setps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.460361691624815*^9, 3.460361705428887*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.460361671625505*^9, 3.46036170543161*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "3"}], "]"}]}], "]"}], "[", 
  "]"}]], "Input",
 CellChangeTimes->{{3.460361754903039*^9, 3.4603617981761723`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.460361761961937*^9, 3.460361798742227*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", "f", "}"}], "}"}], ",", " ", 
    RowBox[{"f", "[", "2", "]"}]}], "]"}], "[", "Print", "]"}]], "Input",
 CellChangeTimes->{{3.460391993349262*^9, 3.4603920098933983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompiledFunction", "::", "\<\"cfsa\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Argument \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Print\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" at position \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(1\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" should be a \\\\\\\"\\\
\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"machine-size real \
number\\\"\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\".\\\\\\\"\\\", \\\"MT\\\
\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/CompiledFunction/cfsa\\\", ButtonNote -> \
\\\"CompiledFunction::cfsa\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.460392010515203*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{3.460392472619432*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"intersection3", "[", "Global`inp", "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.460393453507111*^9, 3.460393486515481*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.2118379999999433`", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.460393462946801*^9, 3.460393488127475*^9}, {
   3.460393635238995*^9, 3.460393644476712*^9}, 3.46039367868381*^9, {
   3.460393809816246*^9, 3.4603938311570873`*^9}, 3.4603939548587313`*^9, 
   3.460394120064356*^9, 3.460394154689913*^9, 3.4604415581110163`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Global`inp"], "Input",
 CellChangeTimes->{{3.460393465292927*^9, 3.4603934674931917`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "4", ",", "3", ",", "5", ",", "8", ",", "7", ",", "6",
      ",", "9", ",", "10", ",", "13", ",", "11", ",", "12", ",", "14", ",", 
     "19", ",", "15", ",", "16", ",", "18", ",", "17", ",", "21", ",", "22", 
     ",", "20", ",", "23"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "4", ",", "2", ",", "3", ",", "5", ",", "8", ",", "7", ",", "6",
      ",", "9", ",", "10", ",", "13", ",", "11", ",", "12", ",", "14", ",", 
     "19", ",", "16", ",", "15", ",", "18", ",", "17", ",", "21", ",", "22", 
     ",", "23", ",", "20"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "3", ",", "4", ",", "2", ",", "7", ",", "5", ",", "8", ",", "6",
      ",", "9", ",", "10", ",", "13", ",", "11", ",", "12", ",", "14", ",", 
     "19", ",", "16", ",", "15", ",", "18", ",", "17", ",", "21", ",", "22", 
     ",", "20", ",", "23"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "4", ",", "3", ",", "8", ",", "5", ",", "7", ",", "6",
      ",", "9", ",", "13", ",", "10", ",", "11", ",", "12", ",", "14", ",", 
     "19", ",", "15", ",", "16", ",", "18", ",", "17", ",", "21", ",", "22", 
     ",", "20", ",", "23"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "4", ",", "3", ",", "2", ",", "5", ",", "8", ",", "6", ",", "7",
      ",", "9", ",", "10", ",", "13", ",", "11", ",", "12", ",", "14", ",", 
     "19", ",", "16", ",", "15", ",", "18", ",", "17", ",", "21", ",", "20", 
     ",", "22", ",", "23"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.460393468344325*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SwappyFind", "[", "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.460393471719647*^9, 3.460393492523076*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.20807000000002063`", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{{3.4603934745106277`*^9, 3.460393492950418*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalRho]rec", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\[Nu]", ",", "_Integer", ",", "1"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "\[Nu]"}], "\[Equal]", "1"}], ",", "\[Nu]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"\[Rho]", "[", 
            RowBox[{
             RowBox[{"\[CapitalRho]rec", "[", 
              RowBox[{"Rest", "[", "\[Nu]", "]"}], "]"}], ",", 
             RowBox[{"First", "[", "\[Nu]", "]"}]}], "]"}], ",", 
           RowBox[{"First", "@", "\[Nu]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", "___", "]"}], ",", "_Integer"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"First", "[", "___", "]"}], ",", "_Integer"}], "}"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Rest", "@", "___"}], ",", " ", "_Integer", ",", "1"}], 
        "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CapitalRho]rec", "[", "___", "]"}], ",", "_Integer", ",", 
         "1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Rho]", "[", "___", "]"}], ",", "_Integer", ",", "1"}], 
        "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.460393666080089*^9, 3.460393670485181*^9}}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{829, 692},
WindowMargins->{{Automatic, 690}, {Automatic, 69}},
ShowSelection->True,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 288, 4, 95, "Title"],
Cell[CellGroupData[{
Cell[880, 30, 21043, 440, 1917, "Input",
 InitializationCell->True],
Cell[21926, 472, 3336, 46, 33, "Output"],
Cell[25265, 520, 3327, 46, 33, "Output"],
Cell[28595, 568, 3327, 46, 33, "Output"],
Cell[31925, 616, 3329, 46, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35291, 667, 96, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[35412, 672, 17292, 449, 1786, "Input",
 InitializationCell->True],
Cell[52707, 1123, 1346, 19, 33, "Output"],
Cell[54056, 1144, 1337, 19, 33, "Output"],
Cell[55396, 1165, 1337, 19, 33, "Output"],
Cell[56736, 1186, 1339, 19, 33, "Output"],
Cell[58078, 1207, 1337, 19, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59452, 1231, 163, 3, 33, "Input"],
Cell[59618, 1236, 345, 11, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60000, 1252, 132, 2, 33, "Input"],
Cell[60135, 1256, 104, 1, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60276, 1262, 286, 3, 53, "Input"],
Cell[60565, 1267, 808, 18, 33, "Output"],
Cell[61376, 1287, 1099, 32, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62512, 1324, 281, 6, 53, "Input"],
Cell[62796, 1332, 208, 5, 33, "Output"],
Cell[63007, 1339, 157, 4, 25, "Print"],
Cell[63167, 1345, 209, 5, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63413, 1355, 188, 4, 33, "Input"],
Cell[63604, 1361, 424, 12, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64065, 1378, 626, 11, 53, "Input"],
Cell[64694, 1391, 866, 14, 33, "Output"],
Cell[65563, 1407, 1046, 20, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66646, 1432, 500, 11, 33, "Input"],
Cell[67149, 1445, 307, 6, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67493, 1456, 103, 1, 33, "Input"],
Cell[67599, 1459, 101, 1, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67737, 1465, 9281, 223, 986, "Input"],
Cell[77021, 1690, 174, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77232, 1698, 36, 0, 47, "Input"],
Cell[77271, 1700, 74, 1, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77382, 1706, 692, 20, 53, "Input"],
Cell[78077, 1728, 73, 1, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78187, 1734, 389, 10, 91, "Input"],
Cell[78579, 1746, 138, 3, 33, "Output"],
Cell[78720, 1751, 115, 2, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78872, 1758, 543, 16, 53, "Input"],
Cell[79418, 1776, 555, 10, 26, "Message"],
Cell[79976, 1788, 144, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80157, 1796, 288, 7, 53, "Input"],
Cell[80448, 1805, 555, 10, 26, "Message"],
Cell[81006, 1817, 144, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81187, 1825, 315, 10, 33, "Input"],
Cell[81505, 1837, 149, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81691, 1845, 270, 7, 47, "Input"],
Cell[81964, 1854, 897, 16, 26, "Message"],
Cell[82864, 1872, 69, 1, 25, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82970, 1878, 173, 4, 33, "Input"],
Cell[83146, 1884, 376, 6, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83559, 1895, 104, 1, 33, "Input"],
Cell[83666, 1898, 1625, 33, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85328, 1936, 153, 3, 33, "Input"],
Cell[85484, 1941, 160, 3, 33, "Output"]
}, Open  ]],
Cell[85659, 1947, 1842, 49, 224, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
